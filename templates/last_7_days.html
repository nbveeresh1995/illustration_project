{% extends 'base.html' %}
{% block topNav %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    $(function() {
    var start = moment().subtract(1, 'days').subtract(6,'days');
    var end = moment().subtract(1, 'days');
    function cb(start, end) {
        $('#reportrange').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
    }
    $('#reportrange').daterangepicker({
        "minDate": "1/1/2016",
        maxDate:moment().subtract(1, 'days'),
        startDate: start,
        endDate: end,
        "opens": "center",
        "alwaysShowCalendars": false,
    }, cb);
    cb(start, end);
});
$(document).ready(function(){
    $(".applyBtn").off().on('click', function(){
        $("#mySelect").val("CustomRange")
    });
});
function func1() {
  document.getElementById("mySelect").value="Week"
};
window.onload=func1;
</script>
<div class="row">
    <div>
        <form class="form-inline" method="post" action="/">
          <div class="form-group mb-2">
              <label style="margin:-2px"  class="lb"><b>SELECT DATES:&nbsp;</b></label>
              <select style="width:200px;border-color:#EB1414 !important" class="form-control sl"  name="option" onChange="myFunction()" id="mySelect">
                <option value="Week">Last 7 days</option>
                <option value="30">This Month (Last 4 Weeks)</option>
                <option value="LastMonth">Prev. Month</option>
                <option value="LastMonthPrevYear">Prev. Month of Past Year</option>
                <option value="12">Last 12 Months</option>
                <option value="LastYear">Last Year</option>
                  <option value="7">Weekly Report</option>
              </select>
          </div>
          <div id="demo" class="form-group "><input class="form-rounded" name="dates" id="reportrange" readonly/></div>
          <button style="margin:10px" type="submit" name="action" value="submit" class="btn btn-danger">Submit</button>
        </form>
    </div>
</div>
{% endblock %}
{% block content %}
<div  style="text-align:center;margin: 70px 10px 20px 10px;">
  <h3>Your Website Traffic Snapshots for {{option}}</h3>
  <p><font size="2"><b>({{dates['pre_date']}})</b></font> vs <font size="2"><b>({{dates['prev_date']}})</b></font></p>
</div>
<div id="mydiv1">
    <div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="row x_title">
          <div class="" role="tabpanel" data-example-id="togglable-tabs">
              <ul id="myTab" class="nav nav-tabs bar_tabs" role="tablist">
                <li role="presentation" class="active"><a href="#tab_content1" id="All-Traffic" role="tab" data-toggle="tab" aria-expanded="true">All Traffic</a></li>
                <li role="presentation" class=""><a href="#tab_content2" role="tab" id="Search-Traffic" data-toggle="tab" aria-expanded="false">Search</a></li>
                <li role="presentation" class=""><a href="#tab_content3" id="Direct-Traffic" role="tab" data-toggle="tab" aria-expanded="true">Direct</a></li>
                <li role="presentation" class=""><a href="#tab_content4" role="tab" id="Referral-Traffic" data-toggle="tab" aria-expanded="false">Referral</a></li>
                <li role="presentation" class=""><a href="#tab_content6" id="Social-Traffic" role="tab" data-toggle="tab" aria-expanded="true">Social</a></li>
                <li role="presentation" class=""><a href="#tab_content7" role="tab" id="Email-Traffic" data-toggle="tab" aria-expanded="false">Email</a></li>
                <li role="presentation" class=""><a href="#tab_content8" role="tab" id="Mobile+Tablet-Traffic" data-toggle="tab" aria-expanded="false">Mobile+Tablet</a></li>
                <li role="presentation" class=""><a href="#tab_content9" role="tab" id="Returning-Users" data-toggle="tab" aria-expanded="false">Return Users</a></li>
              </ul>
              <div class="dashboard_graph" style="margin: -14px 0px -6px 0px !important;">
                  <div id="myTabContent" class="tab-content">
                    <div role="tabpanel" class="tab-pane fade active in" id="tab_content1" aria-labelledby="All-Traffic">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{visitors['visits']}} Visits {% if visitors['change_visits'] > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{visitors['change_visits']}}% |
                              {%if result['conversions']['prev_conversions']['AllTraffic'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['AllTraffic']-result['conversions']['prev_conversions']['AllTraffic'])/result['conversions']['prev_conversions']['AllTraffic'])*100 %}
                              {{result['conversions']['pre_conversions']['AllTraffic']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['AllTraffic']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['AllTraffic'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                        <canvas id="myChart1" height="90"></canvas>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content2" aria-labelledby="Search-Traffic">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{result['session_category'][-3]['Organic Search']}} Visits {% if (result['session_category'][-1]['Organic Search'].split('%')[0]|float) > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{result['session_category'][-1]['Organic Search']}} |
                              {%if result['conversions']['prev_conversions']['sources']['Organic Search'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['sources']['Organic Search']-result['conversions']['prev_conversions']['sources']['Organic Search'])/result['conversions']['prev_conversions']['sources']['Organic Search'])*100 %}
                              {{result['conversions']['pre_conversions']['sources']['Organic Search']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['sources']['Organic Search']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['sources']['Organic Search'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                        <canvas id="myChart2" height="90"></canvas>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content3" aria-labelledby="AdTraffic">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{result['session_category'][-3]['Direct']}} Visits {% if (result['session_category'][-1]['Direct'].split('%')[0]|float) > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{result['session_category'][-1]['Direct']}} |
                              {%if result['conversions']['prev_conversions']['sources']['Direct'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['sources']['Direct']-result['conversions']['prev_conversions']['sources']['Direct'])/result['conversions']['prev_conversions']['sources']['Direct'])*100 %}
                              {{result['conversions']['pre_conversions']['sources']['Direct']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['sources']['Direct']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['sources']['Direct'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                      <canvas id="myChart3" height="90"></canvas>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content4" aria-labelledby="Social Traffic">
                      <div class="container">
                          <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{result['session_category'][-3]['Referral']}} Visits {% if (result['session_category'][-1]['Referral'].split('%')[0]|float) > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{result['session_category'][-1]['Referral']}} |
                              {%if result['conversions']['prev_conversions']['sources']['Referral'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['sources']['Referral']-result['conversions']['prev_conversions']['sources']['Referral'])/result['conversions']['prev_conversions']['sources']['Referral'])*100 %}
                              {{result['conversions']['pre_conversions']['sources']['Referral']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['sources']['Referral']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['sources']['Referral'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                          </div>
                          <canvas id="myChart4" height="90"></canvas>
                      </div>
                    </div>

                    <div role="tabpanel" class="tab-pane fade" id="tab_content6" aria-labelledby="Mobile+Tablet Traffic">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{result['session_category'][-3]['Social']}} Visits {% if (result['session_category'][-1]['Social'].split('%')[0]|float) > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{result['session_category'][-1]['Social']}} |
                              {%if result['conversions']['prev_conversions']['sources']['Social'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['sources']['Social']-result['conversions']['prev_conversions']['sources']['Social'])/result['conversions']['prev_conversions']['sources']['Social'])*100 %}
                              {{result['conversions']['pre_conversions']['sources']['Social']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['sources']['Social']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['sources']['Social'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                      <canvas id="myChart6" height="90"></canvas>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content7" aria-labelledby="Returning Users">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{result['session_category'][-3]['Email']}} Visits {% if (result['session_category'][-1]['Email'].split('%')[0]|float) > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{result['session_category'][-1]['Email']}} |
                              {%if result['conversions']['prev_conversions']['sources']['Email'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['sources']['Email']-result['conversions']['prev_conversions']['sources']['Email'])/result['conversions']['prev_conversions']['sources']['Email'])*100 %}
                              {{result['conversions']['pre_conversions']['sources']['Email']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['sources']['Email']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['sources']['Email'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                      <canvas id="myChart7" height="90"></canvas>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content8" aria-labelledby="Search-Traffic">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{visitors['MobileTablet_visits']}} Visits {% if visitors['change_MobileTablet_visits'] > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{visitors['change_MobileTablet_visits']}}% |
                              {%if result['conversions']['prev_conversions']['MobileTablet'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['MobileTablet']-result['conversions']['prev_conversions']['MobileTablet'])/result['conversions']['prev_conversions']['MobileTablet'])*100 %}
                              {{result['conversions']['pre_conversions']['MobileTablet']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['MobileTablet']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['MobileTablet'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                        <canvas id="myChart8" height="90"></canvas>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content9" aria-labelledby="AdTraffic">
                        <div>
                          <div style="color:#8e9299;font-weight:bold">
                              <div><font size="4"> {{visitors['Return_visits']}} Visits {% if visitors['change_Return_visits'] > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{visitors['change_Return_visits']}}% |
                              {%if result['conversions']['prev_conversions']['ReturningUsers'] != 0%}
                              {% set change = ((result['conversions']['pre_conversions']['ReturningUsers']-result['conversions']['prev_conversions']['ReturningUsers'])/result['conversions']['prev_conversions']['ReturningUsers'])*100 %}
                              {{result['conversions']['pre_conversions']['ReturningUsers']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {{change|round(2)}}%
                              {% else %}
                              {{result['conversions']['pre_conversions']['ReturningUsers']}} Conversions {% if change > 0 %}<img src="static/images/arrowup.png" height="20"/>{% else %}<img src="static/images/arrowdown.png" height="20"/>{% endif %} {%if result['conversions']['pre_conversions']['ReturningUsers'] ==0 %} 0% {% else %} 100% {% endif %}
                              {% endif %}</font></div>
                          </div>
                        </div>
                      <canvas id="myChart9" height="90"></canvas>
                    </div>
                  </div>
              </div>
          </div>
        </div>
      </div>
    </div>
    <div class="page-title">
      <div class="title_left">
        <h3>How did you acquire your users?</h3>
      </div>
    </div>
    <div class="row">
        <div class="col-md-6 col-sm-12 col-xs-12">
            <div class="x_panel">
              <div class="x_title">
                <h2>Traffic by Channel</h2>
                <div class="clearfix"></div>
              </div>
              <div class="x_content">
                <br />
                <canvas id="myChart-1" width="100%"></canvas>
              </div>
            </div>
        </div>
        <div class="col-md-6 col-sm-12 col-xs-12">
            <div class="x_panel">
              <div class="x_title">
                <h2>Traffic by Geo</h2>
                <div class="clearfix"></div>
              </div>
              <div class="x_content">
                  <br />
                  <canvas id="myChart-2" width="100%"></canvas>
              </div>
            </div>
        </div>
    </div>
    <div class="page-title">
      <div class="title_left">
        <h3>Which Areas Needs Improvement?</h3>
      </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">
              <div class="x_title">
                <h2>Channel Performance</h2>
                <div class="clearfix"></div>
              </div>
              <div class="x_content">
                  <br />
                  <canvas id="myChart-4" height="90"></canvas>
              </div>
            </div>
        </div>
    </div>
    <div class="page-title">
      <div class="title_left">
        <h3>Bounce Rate</h3>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div class="">
          <div class="x_content">
            <div class="row">
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                    {% set change = ((result['bouncerate']['present']['MobileTablet']-result['bouncerate']['previous']['MobileTablet'])/result['bouncerate']['previous']['MobileTablet'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['MobileTablet']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['MobileTablet']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Mobile+Tablet</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['Organic Search']-result['bouncerate']['previous']['Organic Search'])/result['bouncerate']['previous']['Organic Search'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['Organic Search']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['Organic Search']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Search</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['Email']-result['bouncerate']['previous']['Email'])/result['bouncerate']['previous']['Email'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['Email']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['Email']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Email</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['Paid Search']-result['bouncerate']['previous']['Paid Search'])/result['bouncerate']['previous']['Paid Search'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['Paid Search']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['Paid Search']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Paid</h3>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <div class="">
          <div class="x_content">
            <div class="row">
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['Social']-result['bouncerate']['previous']['Social'])/result['bouncerate']['previous']['Social'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['Social']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['Social']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Social</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['Direct']-result['bouncerate']['previous']['Direct'])/result['bouncerate']['previous']['Direct'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['Direct']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['Direct']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Direct</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['Referral']-result['bouncerate']['previous']['Referral'])/result['bouncerate']['previous']['Referral'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['Referral']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['Referral']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Referral</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['UK']-result['bouncerate']['previous']['UK'])/result['bouncerate']['previous']['UK'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['UK']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['UK']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>UK</h3>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <div class="">
          <div class="x_content">
            <div class="row">
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['US']-result['bouncerate']['previous']['US'])/result['bouncerate']['previous']['US'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['US']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['US']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>USA</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['ANZ']-result['bouncerate']['previous']['ANZ'])/result['bouncerate']['previous']['ANZ'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['ANZ']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['ANZ']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>ANZ</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['SEA']-result['bouncerate']['previous']['SEA'])/result['bouncerate']['previous']['SEA'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['SEA']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['SEA']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>SEA</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['bouncerate']['present']['France']-result['bouncerate']['previous']['France'])/result['bouncerate']['previous']['France'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['bouncerate']['present']['France']|round(2)}}%<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['bouncerate']['present']['France']|round(2)}}%<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>France</h3>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="page-title">
      <div class="title_left">
        <h3>Avg. Session Duration</h3>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div class="">
          <div class="x_content">
            <div class="row">
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                    {% set change = ((result['avgduration']['present']['MobileTablet']-result['avgduration']['previous']['MobileTablet'])/result['avgduration']['previous']['MobileTablet'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['MobileTablet']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['MobileTablet']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Mobile+Tablet</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['Organic Search']-result['avgduration']['previous']['Organic Search'])/result['avgduration']['previous']['Organic Search'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['Organic Search']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['Organic Search']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Search</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['Email']-result['avgduration']['previous']['Email'])/result['avgduration']['previous']['Email'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['Email']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['Email']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Email</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['Paid Search']-result['avgduration']['previous']['Paid Search'])/result['avgduration']['previous']['Paid Search'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['Paid Search']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['Paid Search']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Paid</h3>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <div class="">
          <div class="x_content">
            <div class="row">
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['Social']-result['avgduration']['previous']['Social'])/result['avgduration']['previous']['Social'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['Social']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['Social']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Social</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['Direct']-result['avgduration']['previous']['Direct'])/result['avgduration']['previous']['Direct'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['Direct']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['Direct']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Direct</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['Referral']-result['avgduration']['previous']['Referral'])/result['avgduration']['previous']['Referral'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['Referral']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['Referral']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>Referral</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['UK']-result['avgduration']['previous']['UK'])/result['avgduration']['previous']['UK'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['UK']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['UK']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>UK</h3>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <div class="">
          <div class="x_content">
            <div class="row">
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['US']-result['avgduration']['previous']['US'])/result['avgduration']['previous']['US'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['US']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['US']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>USA</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['ANZ']-result['avgduration']['previous']['ANZ'])/result['avgduration']['previous']['ANZ'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['ANZ']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['ANZ']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>ANZ</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['SEA']-result['avgduration']['previous']['SEA'])/result['avgduration']['previous']['SEA'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['SEA']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['SEA']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>SEA</h3>
                </div>
              </div>
              <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <div class="tile-stats">
                  <div class="icon">
                  </div>
                  {% set change = ((result['avgduration']['present']['France']-result['avgduration']['previous']['France'])/result['avgduration']['previous']['France'])*100 %}
                    {% if change > 0 %}
                    <div class="count">{{result['avgduration']['present']['France']|round(2)}}<img src="static/images/arrowdown.png" height="35"/><font size="4">{{change|round(2)}}%</font></div>
                    {% else %}
                    <div class="count">{{result['avgduration']['present']['France']|round(2)}}<img src="static/images/arrowup.png" height="35"/><font size="4">{{((change|round(2))|string).split("-")[1]}}%</font></div>
                    {% endif %}
                  <h3>France</h3>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>
</div>
{% block Graph %}
<script>
var chartData1 = {
labels: [
      "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}",
  ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
 datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for item1, item2 in result['traffic']['AllTraffic']['present'][0:30]|zip(result['traffic']['AllTraffic']['previous'][0:30]) %}
    {% if (item2['All Traffic']|int)!=0 %}
    {% set change = ((((item1['All Traffic']|int)-(item2['All Traffic']|int))/(item2['All Traffic']|int)) * 100)|round(2) %}
    {% if change > 100 %}
    "{{100}}",
    {% else %}
    "{{change}}",
    {% endif %}
    {% else %}
    "100",
    {% endif %}
 {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(255, 40, 40, 0.8)',
 backgroundColor: 'rgba(255, 40, 40, 1)',
 borderWidth: 2
},{
   label: 'All Traffic',
   type: 'bar',
   data: [
        {% for item in result['traffic']['AllTraffic']['present'][0:30] %}
            "{{item['All Traffic']}}",
        {% endfor %}
   ],
   borderColor: 'rgba(127, 182, 255, 0.5)',
   backgroundColor: 'rgba(127, 182, 255, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart1").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData1,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
var chartData2 = {
labels: [
            "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}"
        ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
  datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
    {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][1]['Organic Search'].split("%")[0]}}",
    {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(0, 145, 2, 0.8)',
 backgroundColor: 'rgba(0, 145, 2, 1)',
 borderWidth: 2
},{
   label: 'Search Traffic',
   type: 'bar',
   data: [
        {% for i in range(0, result["session_category_line_data"]|length) %}
        "{{result["session_category_line_data"][i][0]['Organic Search']}}",
        {% endfor %}
   ],
   borderColor: 'rgba(233, 237, 158, 0.5)',
   backgroundColor: 'rgba(233, 237, 158, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart2").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData2,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
var chartData3 = {
labels: [
            "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}"
            ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
  datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][1]['Direct'].split("%")[0]}}",
    {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(255, 114, 0, 0.8)',
 backgroundColor: 'rgba(255, 114, 0, 1)',
 borderWidth: 2
},{
   label: 'Direct Traffic',
   type: 'bar',
   data: [
        {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][0]['Direct']}}",
    {% endfor %}
   ],
   borderColor: 'rgba(151, 216, 213, 0.5)',
   backgroundColor: 'rgba(151, 216, 213, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart3").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData3,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
var chartData4 = {
labels: [
    "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}",
    ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
 datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][1]['Referral'].split("%")[0]}}",
    {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(7, 113, 193, 0.8)',
 backgroundColor: 'rgba(7, 113, 193, 1)',
 borderWidth: 2
},{
   label: 'Referral Traffic',
   type: 'bar',
   data: [
    {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][0]['Referral']}}",
    {% endfor %}
   ],
   borderColor: 'rgba(144, 206, 164, 0.5)',
   backgroundColor: 'rgba(144, 206, 164, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart4").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData4,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});

var chartData6 = {
labels: [
            "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}"
            ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
 datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][1]['Social'].split("%")[0]}}",
    {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(0, 99, 132, 0.8)',
 backgroundColor: 'rgba(0, 99, 132, 1)',
 borderWidth: 2
},{
   label: 'Social Traffic',
   type: 'bar',
   data: [
    {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][0]['Social']}}",
    {% endfor %}
   ],
   borderColor: 'rgba(176, 231, 252, 0.8)',
   backgroundColor: 'rgba(176, 231, 252, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart6").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData6,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
var chartData7 = {
labels: [
            "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}"
            ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
 datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for i in range(0, result["session_category_line_data"]|length) %}
    "{{result["session_category_line_data"][i][1]['Email'].split("%")[0]}}",
    {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(47, 70, 79, 0.8)',
 backgroundColor: 'rgba(47, 70, 79, 1)',
 borderWidth: 2
},{
   label: 'Email Traffic',
   type: 'bar',
   data: [
        {% for i in range(0, result["session_category_line_data"]|length) %}
        "{{result["session_category_line_data"][i][0]['Email']}}",
        {% endfor %}
   ],
   borderColor: 'rgba(169, 193, 127, 0.5)',
   backgroundColor: 'rgba(169, 193, 127, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart7").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData7,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
var chartData8 = {
labels:[
          "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}",
        ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
 datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for item1, item2 in result['traffic']['MobileTabletTraffic']['present'][0:30]|zip(result['traffic']['MobileTabletTraffic']['previous'][0:30]) %}
    {% if (item2['traffic']|int)!=0 %}
    {% set change = ((((item1['traffic']|int)-(item2['traffic']|int))/(item2['traffic']|int)) * 100)|round(2) %}
    {% if change > 100 %}
    "{{100}}",
    {% else %}
    "{{change}}",
    {% endif %}
    {% else %}
    "100",
    {% endif %}
 {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(7, 175, 133, 0.8)',
 backgroundColor: 'rgba(7, 175, 133, 0.8)',
 borderWidth: 2
},{
   label: 'Mobile+Tablet Traffic',
   type: 'bar',
   data: [
        {% for item in result['traffic']['MobileTabletTraffic']['present'][0:30] %}
            "{{item['traffic']}}",
        {% endfor %}
   ],
   borderColor: 'rgba(211, 197, 158, 0.5)',
   backgroundColor: 'rgba(211, 197, 158, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart8").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData8,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size: 11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
var chartData9 = {
labels: [
          "{{days[-1]}}","{{days[-2]}}","{{days[-3]}}","{{days[-4]}}","{{days[-5]}}","{{days[-6]}}","{{days[-7]}}"
           ],
datasets: [{
 label: 'Change',
 lineTension: 0,
 yAxisID: '2ndAxis',
 type: 'line',
 datalabels: {
    formatter: function(value, context) {
            return context.dataset.data[context.dataIndex] + ' %';
        }
        },
 data: [
 {% for item1, item2 in result['traffic']['returningusers']['present'][0:30]|zip(result['traffic']['returningusers']['previous'][0:30]) %}
    {% if (item2['traffic']|int)!=0 %}
    {% set change = ((((item1['traffic']|int)-(item2['traffic']|int))/(item2['traffic']|int)) * 100)|round(2) %}
    {% if change > 100 %}
    "{{100}}",
    {% else %}
    "{{change}}",
    {% endif %}
    {% else %}
    "100",
    {% endif %}
 {% endfor %}
 ],
 fill: false,
 borderColor: 'rgba(105, 46, 201, 0.8)',
 backgroundColor: 'rgba(105, 46, 201, 1)',
 borderWidth: 2
},{
   label: 'Return Users',
   type: 'bar',
   data: [
        {% for item in result['traffic']['returningusers']['present'][0:30] %}
            "{{item['traffic']}}",
        {% endfor %}
   ],
   borderColor: 'rgba(175, 145, 191, 0.8)',
   backgroundColor: 'rgba(175, 145, 191, 1)',
   borderWidth: 2
}]
   };
var ctx = document.getElementById("myChart9").getContext("2d");
var myChart = new Chart(ctx, {
   responsive: true,
   type: 'bar',
   data: chartData9,
   options: {
       plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#14141f',
                font: {
                  size:11,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
       scales: {
           yAxes: [{
               ticks: {
                   beginAtZero: true
               },
               stacked: true
           }, {
             type: 'linear',
             id: '2ndAxis',
             position: 'right',
             stacked: true,
             ticks: {
               beginAtZero: true
             }
           }]
       }
   }
});
</script>
<script>
var ctx1 = document.getElementById("myChart-1").getContext('2d');
var myChart1 = new Chart(ctx1, {
    type: 'bar',
    data: {
        labels:['Organic', 'Direct', 'Referral', 'Social', 'Paid', 'Email'],
        datasets: [{
            label: ['Sources'],
            data: [
                "{{result['session_category'][8].get('Organic Search', 0)}}",
                "{{result['session_category'][8].get('Direct', 0)}}",
                "{{result['session_category'][8].get('Referral', 0)}}",
                "{{result['session_category'][8].get('Social', 0)}}",
                "{{result['session_category'][8].get('Paid Search', 0)}}",
                "{{result['session_category'][8].get('Email', 0)}}",
            ],
            backgroundColor: [
                  'rgba(221, 147, 51, 0.7)',
                  'rgba(221, 147, 51, 0.7)',
                  'rgba(221, 147, 51, 0.7)',
                  'rgba(221, 147, 51, 0.7)',
                  'rgba(221, 147, 51, 0.7)',
                  'rgba(221, 147, 51, 0.7)',
                  ],
            borderColor: [
                'rgba(221, 147, 51, 1)',
                'rgba(221, 147, 51, 1)',
                'rgba(221, 147, 51, 1)',
                'rgba(221, 147, 51, 1)',
                'rgba(221, 147, 51, 1)',
                'rgba(221, 147, 51, 1)',
            ],
            borderWidth: 0.5
        },
        {
        datalabels: {
            color:'#000000',
            offset: -20,
      	    formatter: function(value, context) {
                    return context.dataset.data[context.dataIndex] + ' %';
                }
                },
            label: ['Change'],
            type: 'line',
            fill: false,
            data: [
                "{{result['session_category'][-1].get('Organic Search', "0%").split("%")[0]}}",
                "{{result['session_category'][-1].get('Direct', "0%").split("%")[0]}}",
                "{{result['session_category'][-1].get('Referral', "0%").split("%")[0]}}",
                "{{result['session_category'][-1].get('Social', "0%").split("%")[0]}}",
                "{{result['session_category'][-1].get('Paid Search', "0%").split("%")[0]}}",
                "{{result['session_category'][-1].get('Email', "0%").split("%")[0]}}"
                ],
            backgroundColor: [
                  'rgba(225, 52, 65, 0.8)',
                  ],
            borderColor: [
                  'rgba(225, 52, 65, 0.4)',
                  ]
        }]
    },
    options: {
        plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#6b6a66',
                font: {
                  size: 12,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
        title: {
			display: false,
			text: 'Traffic by Channel'
			},
        tooltips: {
            mode: 'index',
            },
        scales: {
            yAxes: [{
                stacked: true,
                gridLines: {
                    display:true
                },
                ticks: {
                    beginAtZero:true
                }
            }],
            xAxes: [{
                stacked: true,
                gridLines: {
                    display:true
                },
            }]
        }
    }
});

var ctx1 = document.getElementById("myChart-2").getContext('2d');
var myChart1 = new Chart(ctx1, {
    type: 'bar',
    data: {
        labels: [{% for item in result['sessions'] %}
                  {%if item['Country'] != 'Total' %}
                  "{{item['Country']}}",
                  {% endif %}
              {% endfor %}],
        datasets: [{
            label: ['sessions'],
            data: [{% for item in result['sessions'] %}
                    {%if item['Country'] != 'Total' %}
                  "{{item['Current']}}",
                  {% endif %}
                  {% endfor %}],
            backgroundColor: [{% for item in result['sessions'] %}
                    {%if item['Country'] != 'Total' %}
                  'rgba(45, 180, 152, 0.7)',
                  {% endif %}
                  {% endfor %}],
            borderColor: [{% for item in result['sessions'] %}
                    {%if item['Country'] != 'Total' %}
                  'rgba(45, 180, 152, 1)',
                  {% endif %}
                  {% endfor %}],
            borderWidth: 0.5
        },
        {
        datalabels: {
            color:'#000000',
            offset: -20,
      	    formatter: function(value, context) {
                    return context.dataset.data[context.dataIndex] + ' %';
                }
                },
            label: ['Change'],
            type: 'line',
            fill: false,
            data: [{% for item in result['sessions'] %}
                    {%if item['Country'] != 'Total' %}
                  {{item['Change'].split('%')[0]}},
                  {% endif %}
                  {% endfor %}],
            backgroundColor: [
                  'rgba(225, 52, 65, 0.8)',
                  ],
            borderColor: [
                  'rgba(225, 52, 65, 0.4)',
                  ]
        }]
    },
    options: {
        plugins: {
              datalabels: {
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#6b6a66',
                font: {
                  size: 12,
                  weight: 600
                },
                offset: 0,
                padding: 0,
              }
            },
        title: {
			display: false,
			text: 'Traffic by Channel'
			},
        tooltips: {
            mode: 'index',
            },
        scales: {
            yAxes: [{
                stacked: true,
                gridLines: {
                    display:true
                },
                ticks: {
                    beginAtZero:true
                }
            }],
            xAxes: [{
                stacked: true,
                gridLines: {
                    display:true
                },
            }]
        }
    }
});

var barChartData = {
        labels: ['UK', 'USA', 'France', 'China', 'India', 'SEA', 'ANZ','ROW'],
        datasets: [{
            label: 'Organic Search',
            backgroundColor: [
               'rgba(51, 100, 255, 0.8)','rgba(51, 100, 255, 0.8)','rgba(51, 100, 255, 0.8)','rgba(51, 100, 255, 0.8)',
               'rgba(51, 100, 255, 0.8)','rgba(51, 100, 255, 0.8)','rgba(51, 100, 255, 0.8)','rgba(51, 100, 255, 0.8)'],
            borderColor: [
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)',
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)'],
            borderWidth: 0.5,
            data: {{ Change.get('Organic Search', 0) }}
        }, {
            label: 'Direct',
            backgroundColor: [
               'rgba(255, 49, 49, 0.8)','rgba(255, 49, 49, 0.8)','rgba(255, 49, 49, 0.8)','rgba(255, 49, 49, 0.8)',
               'rgba(255, 49, 49, 0.8)','rgba(255, 49, 49, 0.8)','rgba(255, 49, 49, 0.8)','rgba(255, 49, 49, 0.8)'],
            borderColor: [
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)',
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)'],
            borderWidth: 0.5,
            data: {{ Change.get('Direct', 0) }}
        }, {
            label: 'Referral',
            backgroundColor: [
               'rgba(252, 135, 54,0.8)','rgba(252, 135, 54,0.8)','rgba(252, 135, 54,0.8)','rgba(252, 135, 54,0.8)',
               'rgba(252, 135, 54,0.8)','rgba(252, 135, 54,0.8)','rgba(252, 135, 54,0.8)','rgba(252, 135, 54,0.8)'],
            borderColor: [
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)',
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)'],
            borderWidth: 0.5,
            data: {{ Change.get('Referral',0) }}
        }, {
            label: 'Social',
            backgroundColor: [
               'rgba(22, 152, 31, 0.5)','rgba(22, 152, 31, 0.5)','rgba(22, 152, 31, 0.5)','rgba(22, 152, 31, 0.5)',
               'rgba(22, 152, 31, 0.5)','rgba(22, 152, 31, 0.5)','rgba(22, 152, 31, 0.5)','rgba(22, 152, 31, 0.5)'],
            borderColor: [
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)',
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)'],
            borderWidth: 0.5,
            data: {{ Change.get('Social', 0) }}
        }, {
            label: 'Paid Search',
            backgroundColor: [
               'rgba(218, 14, 247, 0.8)','rgba(218, 14, 247, 0.8)','rgba(218, 14, 247, 0.8)','rgba(218, 14, 247, 0.8)',
               'rgba(218, 14, 247, 0.8)','rgba(218, 14, 247, 0.8)','rgba(218, 14, 247, 0.8)','rgba(218, 14, 247, 0.8)'],
            borderColor: [
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)',
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)'],
            borderWidth: 0.5,
            data: {{ Change.get('Paid Search', 0) }}
        }, {
            label: 'Email',
            backgroundColor: [
               'rgba(1, 169, 214, 0.8)','rgba(1, 169, 214, 0.8)','rgba(1, 169, 214, 0.8)','rgba(1, 169, 214, 0.8)',
               'rgba(1, 169, 214, 0.8)','rgba(1, 169, 214, 0.8)','rgba(1, 169, 214, 0.8)','rgba(1, 169, 214, 0.8)'],
            borderColor: [
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)',
               'rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)','rgba(255, 255, 255, 1)'],
            borderWidth: 0.5,
            data: {{ Change.get('Email', 0) }}
        }]

    };
var ctx = document.getElementById('myChart-4').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'bar',
    data: barChartData,
    options: {
        plugins: {
              datalabels: {
                display:false,
                align: 'end',
                anchor: 'end',
                backgroundColor: null,
                borderColor: null,
                borderRadius: 4,
                borderWidth: 1,
                color:'#6b6a66',
                font: {
                  size: 12,
                  weight: 600
                },
                offset: 4,
                padding: 0,
              }
            },
        title: {
            display: false,
            text: 'Traffic Performance (% Change) by Region & Source'
        },
        tooltips: {
            mode: 'index',
        },
        responsive: true,
        scales: {
            xAxes: [{
                stacked: true,
            }],
            yAxes: [{
                stacked: true,
                <!--ticks: {-->
                        <!--max: 80,-->
                        <!--min: -80,-->
                    <!--}-->
            }]
        }
    }
});
</script>
{% endblock %}
{% endblock %}